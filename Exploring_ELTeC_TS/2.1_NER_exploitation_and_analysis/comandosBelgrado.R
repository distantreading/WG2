# Second part
ne_srp<-read.table("tableSerbian.R", header=TRUE)
summary(ne_srp)
ne_slv<-read.table("tableSlovenian.R", header=TRUE)
summary(ne_slv)
ne_por<-read.table("tablePortuguese.R",header=TRUE)
summary(ne_por)
ne_slv$NE<-ne_slv$NE-ne_slv$deriv.per
list <- c("por","nor","slv","srp","deu","hun","fra","eng")
for (i in list) {
  filename <- paste0("col_", i)
  wd <- paste0("meta", i, ".R")
  assign(filename, read.table(wd,header=TRUE))
}
summary(col_eng) # to test if they were read successfully
for (i in list) {
  filename <- paste0("prop_", i)
  wd <- paste0("proprios", i, ".R")
  assign(filename, read.table(wd,header=TRUE))
}
summary(prop_fra)
slovenian<-merge(ne_slv,col_slv,by.x=c("Ficheiro"),by.y=c("file"))
portuguese<-merge(ne_por,col_por,by.x=c("Ficheiro"),by.y=c("file"))
serbian<-merge(ne_srp,col_srp,by.x=c("Ficheiro"),by.y=c("file"))
serbian2<-subset(serbian,PERS!=0)
slovenian$relne<-slovenian$NE/slovenian$words
portuguese$relne<-portuguese$NE/portuguese$words
serbian2$relne<-serbian2$NE/serbian2$words
serbian2$relne<-serbian2$NE/serbian2$words
boxplot(slovenian$relne~slovenian$canon)
boxplot(slovenian$relne~slovenian$gender)
boxplot(slovenian$relne~slovenian$size)
boxplot(slovenian$relne~slovenian$period)
par(mfrow=c(1,3))
boxplot(portuguese$relne~portuguese$period,ylim=c(0,0.12), ylab="Number of NE per number of words",xlab="20-year period")
boxplot(slovenian$relne~slovenian$period,ylim=c(0,0.12), ylab="Number of NE per number of words",xlab="20-year period")
boxplot(serbian2$relne~serbian2$period,ylim=c(0,0.12), ylab="Number of NE per number of words",xlab="20-year period")
french<-merge(prop_fra,col_fra,by=c("file"))
french$relprop<-french$proper/french$words
boxplot(french$relprop~french$period)
german<-merge(prop_deu,col_deu,by=c("file"))
german$relprop<-german$proper/german$words
boxplot(german$relprop~german$period)

english<-merge(prop_eng,col_eng,by=c("file"))
english$relprop<-english$proper/english$words
boxplot(english$relprop~english$period)

norwegian<-merge(prop_nor,col_nor,by=c("file"))
norwegian$relprop<-norwegian$proper/norwegian$words
boxplot(norwegian$relprop~norwegian$period)

hungarian<-merge(prop_hun,col_hun,by=c("file"))
hungarian$relprop<-hungarian$proper/hungarian$words
boxplot(hungarian$relprop~hungarian$period)

portuguese3<-merge(prop_por,col_por,by=c("file"))
portuguese3$relprop<-portuguese3$proper/portuguese3$words
boxplot(portuguese3$relprop~portuguese3$period)

serbian3<-merge(prop_srp,col_srp,by=c("file"))
serbian3$relprop<-serbian3$proper/serbian3$words
boxplot(serbian3$relprop~serbian3$period)

slovenian3<-merge(prop_slv,col_slv,by=c("file"))
slovenian3$relprop<-slovenian3$proper/slovenian3$words
boxplot(slovenian3$relprop~slovenian3$period)


all<-rbind(hungarian,english,german,norwegian,french,portuguese3, serbian3,slovenian3)
all_clean<-all[all$file!="file",]
all_clean$lang <-as.factor(sub( "^([A-Z][A-Z][A-Z]*).*", "\\1", all_clean$file, perl=TRUE))
summary(all_clean)
boxplot(all_clean$relprop~all_clean$lang)
boxplot(all_clean$relprop~all_clean$gender+all_clean$lang)

allport <- merge(portuguese,portuguese3,by.x=c("Ficheiro","words", "date","gender","size","canon","period"),by.y=c("file","words",
  "date","gender","size","canon","period"))
plot(allport$relne,allport$relprop)
cor(allport$relne,allport$relprop)

allslv <- merge(slovenian,slovenian3,by.x=c("Ficheiro","words","date","gender","size","canon","period"),by.y=c("file","words","date","gender","size","canon","period"))
plot(allslv$relne,allslv$relprop)
cor(allslv$relne,allslv$relprop)

allsrp <- merge(serbian2,serbian3,by.x=c("Ficheiro","words","date","gender","size","canon","period"),by.y=c("file","words","date","gender","size","canon","period"))
plot(allsrp$relne,allsrp$relprop)
cor(allsrp$relne,allsrp$relprop)


par(mfrow=c(1,3))
plot(allport$relne,allport$relprop, main="Portuguese",ylim=c(0.01,0.12))
plot(allslv$relne,allslv$relprop, main="Slovenian",ylim=c(0.01,0.12))
plot(allsrp$relne,allsrp$relprop, main="Serbian",ylim=c(0.01,0.12))

unifport<-subset(allport,TRUE,c(1:10, 15:18))
unifsrp<-subset(allsrp,TRUE,c(1:10, 15:18))
colnames(unifsrp)[9]<-"PLACE"
colnames(allslv)[8]<-"PERS"
colnames(allslv)[9]<-"PLACE"
colnames(allslv)[10]<-"ORG"
unifslv<-subset(allslv,TRUE,c(1:10, 13:16)) 
allne<-rbind(unifport,unifslv,unifsrp)
allne$lang <-as.factor(sub( "^([A-Z][A-Z][A-Z]*).*", "\\1", 
  allne$Ficheiro, perl=TRUE))
summary(allne)

par(mfrow=c(1,1))
boxplot(allne$NE~allne$lang)
allne$relPERS<-allne$PERS/allne$words
allne$relPLACE<-allne$PLACE/allne$words
allne$relORG<-allne$ORG/allne$words
boxplot(allne$relPERS~allne$lang)
boxplot(allne$relPERS~allne$lang+allne$canon)
boxplot(allne$relPERS~allne$lang+allne$period+allne$gender, las=2)

# Third part
napoleon <- read.table("napoleon.R", header=TRUE)
summary(napoleon)
napoleon$lang <-as.factor(sub( "^([A-Z][A-Z][A-Z]*).*", "\\1", napoleon$file, perl=TRUE))
summary(napoleon)

addition_n<-vector()
list <- c("POR","NOR","SLV","SRP","DEU","HU","FRA","ENG")
for (i in list) {
  addition_n[i] <- sum(napoleon[napoleon$lang==i,]$palavra)
}
barplot(addition_n, main="Napoleon in 8 European literatures: amount of references")
#pie(addition_n) 
barplot(table(napoleon[napoleon$palavra!=0,]$lang), main="Napoleon in 8 European literatures: number of works citing him")

christmas <- read.table("christmas.R", header=TRUE)
summary(christmas)
christmas$lang <-as.factor(sub( "^([A-Z][A-Z][A-Z]*).*", "\\1", 
  christmas$file, perl=TRUE))
summary(christmas)
addition_c<-vector()
list <- c("POR","NOR","SLV","SRP","DEU","HU","FRA","ENG")
for (i in list) {
  addition_c[i] <- sum(christmas[christmas$lang==i,]$palavra)
}
barplot(addition_c, main="Christmas in 8 European literatures: amount of references")
#pie(addition_c) 
barplot(table(christmas[christmas$palavra!=0,]$lang), main="Christmas in 8 European literatures: number of works citing it")

